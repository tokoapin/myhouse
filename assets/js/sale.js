$(function(){$.extend({getUrlVars:function(){var e,t,a,s;s=[];e=void 0;t=window.location.href.slice(window.location.href.indexOf("?")+1).split("&");a=0;while(a<t.length){e=t[a].split("=");s.push(e[0]);s[e[0]]=decodeURIComponent(e[1]);a++}return s},getUrlVar:function(e){return $.getUrlVars()[e]}});$("#submit_date").datepicker({dateFormat:"yy-mm-dd"});return $(document).on("click",".manage_house",function(e){var t,a,s;t=$("#manage-template").html();a=Handlebars.compile(t);s=$(this).data("uid");return $.ajax({url:"/sale/item/"+s,dataType:"json",type:"GET",success:function(e){var t;if(e.success_text){e.item.is_submit=+e.item.is_submit;e.item.is_owner=+e.item.is_owner;t=a(e.item);return $("#manage_house").html(t)}}})}).on("click",".setting",function(e){var t,a,s,n,i,r,o;e.preventDefault();i=$(this).data("mode")||"";a=$("#setting_form").serializeObject();r=$(this).data("uid")||"";t={};n="";switch(i){case"reservation":case"deal":$("#reservation, #deal").hide();return $("#"+i).show();case"update_reservation":case"update_deal":if(i==="update_reservation"){n="已預約/續約成功"}else{if(i==="update_deal"){n="設定已成交"}}return $.ajax({url:"/sale/setting/"+r,dataType:"json",data:$.extend(a,{mode:i}),type:"POST",success:function(e){if(e.success_text){return alert(n)}}});case"open":case"close":s=$(this).data("key")||"";o=$(this).data("value")||"";return $.ajax({url:"/sale/setting/"+r,dataType:"json",data:{key:s,value:o,mode:i},type:"POST",success:function(e){if(e.success_text){alert("設定完成，重新整理網頁");return window.location.reload()}}});case"delete":if(!confirm("確定要刪除此銷售物件?")){return true}return $.ajax({url:"/sale/delete/"+r,dataType:"json",type:"GET",success:function(e){if(e.success_text){alert("刪除完成，重新整理網頁");return window.location.reload()}}})}}).on("shown","#manage_house",function(){return $("#submit_date").datepicker({dateFormat:"yy-mm-dd"})})});