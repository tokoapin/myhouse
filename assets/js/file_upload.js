$(function(){var e,a;e=$("input[name=upload_file_name]").val()?$("input[name=upload_file_name]").val():"file_list";a=$("#file_upload").data("type")||"";$("#file_upload").uploadify({uploader:"/assets/js/libs/jquery/uploadify/uploadify.swf",script:"/files/upload?type="+a,cancelImg:"/assets/js/libs/jquery/uploadify/cancel.png",folder:"/uploads/",auto:true,buttonText:"Select Upload File",displayData:true,fileDataName:"userfile",removeCompleted:false,multi:true,onComplete:function(a,t,l,i,n){var u,s,d;u=void 0;s=void 0;d=void 0;d=jQuery.parseJSON(i);$("#file_upload"+t).slideUp("1000",function(){return $(this).remove()});if(d.error!==""){u=$("#message").html();return $("#message").html(u+d.error)}else{u='<li class="span2" style="text-align:center"><a href="#" class="thumbnail"><img src="/files/get/'+d.upload_data.file_name+'/160/120" alt=""></a><input type="hidden" name="'+e+'[]" value="'+d.upload_data.id+'"><button type="button" data-id="'+d.upload_data.id+'" class="btn btn-danger delete_file">刪除檔案</button></li>';return $(".thumbnails").prepend(u)}}});$(document).on("click",".delete_file",function(e){var a,t;t=this;e.preventDefault();a=$(t).data("id");if(confirm("確定刪除資料?")){return $.ajax({url:"/files/ajax",dataType:"json",type:"POST",data:{id:a,mode:"delete"},success:function(e){if(e.success_text){return $(t).parent().fadeOut("slow",function(){return $(t).remove()})}}})}});$(".thumbnails").sortable();return $(".thumbnails").disableSelection()});